<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en-US">
<!--********************************************-->
<!--*       Generated from PreTeXt source      *-->
<!--*       on 2022-08-23T22:38:10-04:00       *-->
<!--*   A recent stable commit (2020-08-09):   *-->
<!--* 98f21740783f166a773df4dc83cab5293ab63a4a *-->
<!--*                                          *-->
<!--*         https://pretextbook.org          *-->
<!--*                                          *-->
<!--********************************************-->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="robots" content="noindex, nofollow">
</head>
<body>
<div class="solution solution-like">
<h6 xmlns:svg="http://www.w3.org/2000/svg" class="heading">
<span class="type">Solution</span><span class="space"> </span><span class="codenumber">3.4.19.1</span><span class="period">.</span>
</h6>
<p xmlns:svg="http://www.w3.org/2000/svg">Let \(U\) be the set of all pairings of the $2n$ pets, and define the forbidden set \(A_i\) as the set of all pairings where the \(i\)th heaviest cat <em class="emphasis">is</em> paired with the \(i\)th heaviest dog.</p>
<p>Then the desired quantity is</p>
<div xmlns:svg="http://www.w3.org/2000/svg" class="displaymath">
\begin{equation*}
N = |A_1^c \cap A_2^c \cap \cdots \cap A_n^c|\text{,}
\end{equation*}
</div>
<p class="continuation">which is the number of pairings satisfying the given condition. By <a class="xref" data-knowl="./knowl/thm-pie.html" title="Theorem 3.2.6: Principle of Inclusion-Exclusion">TheoremÂ 3.2.6</a>, this is equal to the sum</p>
<div xmlns:svg="http://www.w3.org/2000/svg" class="displaymath">
\begin{align*}
N \amp = \sum_{S \subseteq \{1,2,\ldots,n\}} (-1)^{|S|} \left| \bigcap_{i \in S} A_i\right| \\
\amp = |U| - \sum_{1 \leq i \leq n} |A_i| + \sum_{1 \leq i \lt j \leq n} |A_i \cap A_j| - \cdots + (-1)^n|A_1 \cap A_2 \cap \cdots \cap A_n|.
\end{align*}
</div>
<p xmlns:svg="http://www.w3.org/2000/svg">First, we compute \(|A_i|\) by observing that once the \(i\)th heaviest dog and \(i\)th heaviest cat are paired up, then we can pair up the other \(2n-2\) pets with no restrictions.</p>
<p>The number of ways to do this can be determined as follows:</p>
<ul class="disc">
<li>Create a pair out of the \(2n-2\) remaining animals: \(\binom{2n-2}{2}\) ways.</li>
<li>Create a pair out of the \(2n-4\) remaining animals: \(\binom{2n-4}{2}\) ways.</li>
<li>\(\displaystyle \vdots\)</li>
<li>Create a pair out of the 4 remaining animals: \(\binom{4}{2}\) ways.</li>
<li>Create a pair out of the 2 remaining animals: \(\binom{2}{2} = 1\) way.</li>
<li>Divide by \((n-1)!\) since the order in which pairs are formed doesn't matter.</li>
</ul>
<p class="continuation">Hence for any \(i = 1,2,\ldots,n\) we have</p>
<div xmlns:svg="http://www.w3.org/2000/svg" class="displaymath">
\begin{align*}
|A_i| \amp = \binom{2n-2}{2}\binom{2n-4}{2}\cdots\binom{4}{2}\binom{2}{2}\dfrac{1}{(n-1)!}\\
\amp = \dfrac{(2n-2)!}{2!\ (2n-4)!}\cdot\dfrac{(2n-4)!}{2!\ (2n-6)!}\cdots\dfrac{4!}{2!\ 2!}\cdot \dfrac{2!}{2! \ 0!} \cdot \dfrac{1}{(n-1)!}\\
\amp = \dfrac{(2n-2)!}{(2!)^{n-1}\ (n-1)!}
\end{align*}
</div>
<p>For the pairwise intersections \(|A_i \cap A_j|\) the only difference is that we are fixing two pairs to begin, and then grouping the remaining \(2n-4\) animals into pairs. This means that for any \(i \ne j\) we have</p>
<div xmlns:svg="http://www.w3.org/2000/svg" class="displaymath">
\begin{align*}
|A_i \cap A_j| \amp = \binom{2n-4}{2}\binom{2n-6}{2}\cdots\binom{4}{2}\binom{2}{2}\dfrac{1}{(n-1)!}\\
\amp = \dfrac{(2n-4)!}{2!\ (2n-6)!}\cdot\dfrac{(2n-6)!}{2!\ (2n-8)!}\cdots\dfrac{4!}{2!\ 2!}\cdot \dfrac{2!}{2! \ 0!} \cdot \dfrac{1}{(n-1)!}\\
\amp = \dfrac{(2n-4)!}{(2!)^{n-2}\ (n-2)!}
\end{align*}
</div>
<p>And in general, the cardinality of the intersection of \(k\) of the \(A_i\)'s is:</p>
<div xmlns:svg="http://www.w3.org/2000/svg" class="displaymath">
\begin{equation*}
|A_{i_1} \cap A_{i_2} \cap \cdots \cap A_{i_k}| = \dfrac{(2n-2k)!}{(2!)^{n-k}\ (n-k)!}\text{.}
\end{equation*}
</div>
<p xmlns:svg="http://www.w3.org/2000/svg">Note this is also true when we pick \(k = 0\text{:}\) we just get the number of ways we can group \(2n\) animals into pairs unrestricted.</p>
<p>Since this quantity is only dependent on how many \(A_i\)'s we are taking, we can write the inclusion-exclusion as:</p>
<div xmlns:svg="http://www.w3.org/2000/svg" class="displaymath">
\begin{align*}
N \amp = |U| - \binom{n}{1}|A_1| + \binom{n}{2}|A_1 \cap A_2| - \cdots + (-1)^n\binom{n}{n}|A_1 \cap A_2 \cap \cdots \cap A_n|\\
\amp = \sum_{k=0}^n (-1)^k\binom{n}{k}\dfrac{(2n-2k)!}{(2!)^{n-k}\ (n-k)!}.
\end{align*}
</div>
</div>
<span class="incontext"><a href="exercises-principles.html#solution-42">in-context</a></span>
</body>
</html>
